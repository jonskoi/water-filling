# water-filling
OFDM 시스템에서는 여러 서브캐리어(subcarrier)를 사용해 동시에 데이터를 전송합니다.

그런데 무선 통신에서 채널의 품질은 주파수마다 다릅니다. 이는, 각 채널에서 SNR값이 다름을 의미합니다.

이런 환경에서 총 전력 제한이 있는 경우, 어떻게 전력을 배분해야 Capacity(Total data rate) 최대로 만들 수 있을까요?

​

각 서브캐리어의 채널 이득(Channel gain)이 다르므로, 전력을 1/n으로 똑같이 나누면 비효율적일 수 있습니다.

즉 각 서브캐리어에 얼마나 전력을 배분하여 총 데이터 전송률을 최대화할 수 있는 방법이 워터필링 알고리즘입니다.

​

​

💧 워터필링(Water-Filling)?

“물을 붓는다”는 표현은 어디에서 왔을까?

워터필링(Water-Filling)이라는 이름은 말 그대로 물을 여러 개의 빈 컵에 채워 넣는 과정을 비유한 것입니다.

​

예를 들어, 주전자에 물이 1리터 있고, 크기가 제각각인 컵이 5개 있다고 가정해봅시다.

그런데 이 컵들은 검은 천으로 덮여 있어 외형은 보이지 않지만, 컵의 개수만 알고 있습니다.

이제 물을 최대한 버리지 않고 컵에 나눠 담아야 한다면 어떻게 해야 할까요?

​

단순히 컵의 개수만큼 200ml씩 나눠 붓는다면, 어떤 컵은 넘치고 어떤 컵은 덜 찰 수 있습니다.

따라서 이상적인 방법은 각 컵의 실제 용량에 맞춰 물을 붓는 것입니다.

​

이러한 개념이 무선 통신에서의 전력 분배 문제와 정확히 일치합니다.

​

무선 채널의 품질은 랜덤하고 정확히 알기 어렵기 때문에, 각 채널을 하나의 ‘컵’으로, 채널에 할당할 전력을 ‘물’로 비유합니다.

워터필링 알고리즘은 이처럼 제한된 전력을 각 채널의 특성에 맞게 최적으로 분배하는 과정을 물 붓는 상황에 빗대어 설명한 것입니다.

​

​

🎯 최적화 문제

워터필링 알고리즘을 위해선 컨벡스 최적화(convex optimization)이 필요합니다.

​

서브캐리어의 개수가 N개이고,

서브캐리어 k의 채널 이득이 gₖ, 해당 서브캐리어에 할당된 전력이 εₖ라고 할 때,

최적화 문제는 다음과 같습니다:
